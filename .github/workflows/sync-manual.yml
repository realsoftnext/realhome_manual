name: Sync Manual to App

on:
  push:
    branches:
      - main
    paths:
      - 'manual/**/*.md'

jobs:
  sync:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
      
      - name: Sync manual files
        run: |
          # manual í´ë”ì˜ .md íŒŒì¼ì„ app/manual êµ¬ì¡°ë¡œ ë™ê¸°í™”
          for file in manual/*.md; do
            if [ "$file" != "manual/README.md" ]; then
              filename=$(basename "$file" .md)
              targetDir="app/manual/$filename"
              targetFile="$targetDir/page.mdx"
              
              # í´ë” ìƒì„±
              mkdir -p "$targetDir"
              
              # íŒŒì¼ ë³µì‚¬ (.md -> .mdx)
              cp "$file" "$targetFile"
              echo "âœ“ Synced: $file -> $targetFile"
            fi
          done
      
      - name: Commit and push if changed
        run: |
          git config --global user.name 'GitHub Actions'
          git config --global user.email 'actions@github.com'
          git add app/manual/
          git diff --quiet && git diff --staged --quiet || (git commit -m "ðŸ”„ Auto-sync: manual â†’ app/manual" && git push)
